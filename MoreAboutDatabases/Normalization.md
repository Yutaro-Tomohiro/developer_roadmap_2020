# 正規化

## 正規化とは

正規化はテーブル内のデータに矛盾や重複を生じさせないために行われる。

正規化は、

非正規形 → 第 1 正規形 → 第 2 正規形 → 第 3 正規形

という段階に別れている。

(本当は第３正規形より高次の正規化もあるが、ここでは扱わない)

## 非正規形

非正規形とは、正規化されていない繰り返し部分を持つ表のこと。

例えば以下のような伝票があるとして、

![normalization1](../Images/normalization1.png)

![normalization2](../Images/normalization2.png)

![normalization3](../Images/normalization3.png)

この伝票１枚１枚が１件のレコードとして並べると以下のようになる。

![normalization4](../Images/normalization4.png)

見ての通り、繰り返しになっている部分があり、各レコードの長さがバラバラになっている。

これだと、リレーショナルデータベースとして管理しにくい。

## 第 1 正規形

第１正規化をすると、繰り返しの部分を分離して、素直な２次元の表の形に直すことができる。

非正規化から第１正規化の手順は

1. 繰り返し部分を切り離す
2. 切り離したデータを加工して独立したレコードにする
3. 独立させたレコードを挿入する

これを上記の例で再現すると、以下のようになる。

![normalization5](../Images/normalization5.png)

## 関数従属と部分関数従属

### 関数従属

関数従属とは主キーに対して一意に決まっている列の値。

例えば、以下のようなテーブルがあるとする。

| 社員番号 | 名前     | 部署   |
| -------- | -------- | ------ |
| 200901   | 田中一郎 | 営業部 |
| 300902   | 鈴木隆   | 開発部 |

このテーブルでは「社員番号」が決まると、「名前」と「部署」が決まる関係にある。

このような関係を**関数従属**という。

※例えば「名前」は社員番号に関数従属している、などと使う。

また、複数の値が主キーとなっている場合を**複合キー**という。

例えば、以下のようなテーブルがあるとする。

| 学年 | クラス | 出席番号 | 名前     |
| ---- | ------ | -------- | -------- |
| 2    | A      | 12       | 田中一郎 |
| 3    | C      | 23       | 鈴木隆   |

このようなテーブルでは「学年」、「クラス」、「出席番号」が合わさって主キーになり、名前が一意に決まる。

### 部分関数従属

複合キーの一部の項目だけで、列の値が一意に定まる関係を**部分関数従属**という。

![normalization5](../Images/normalization5.png)

上のテーブルでは、レコードを特定するには「伝票番号」と「商品コード」の複合キーが必要となる。

しかし、「日付」、「顧客コード」、「顧客名」は「伝票番号」だけで定まり、「商品名」と「単価」は「商品コード」だけで定まる。

## 第 2 正規形

## 第 3 正規形
