# REST

## REST とは

**Re**presentational **S**tate **T**ransfer の略のことで、日本語に訳すと、「描写の状態の転送」という感じ。

REST とは※アーキテクチャスタイルの１つで、以下のようなアーキテクチャスタイルの特徴を組み合わせてできたもの。

- クライアント/サーバ
- ステートレス
- キャッシュ
- 統一インターフェース
- 階層化システム
- コードオンデマンド

とりあえず、以下にこの６個のアーキテクチャスタイルについて説明する。

※アーキテクチャスタイル：複数のアーキテクチャ(設計の構成)に共通して見られる設計原則の集合のこと

### クライアント/サーバ

リクエストを送るクライアントとレスポンスを返すサーバで役目を分けるアーキテクチャスタイル。

### ステートレス

ステートレスとは「状態がない」という意味で、やり取りにおいてサーバーはクライアントのセッション(Cookie)情報を保持しないアーキテクチャスタイルのこと。

逆にセッション(Cookie)情報を保持するのはステートフルなやり取りと言える。

### キャッシュ

キャッシュとは一度取得した Web ページの情報(リソース)をクライアントのストレージに保存して、呼び出すたびに再利用するアーキテクチャスタイルのこと。

メリットとして、サーバとクライアント間でのデータ通信を減らして、ネットワーク帯域の利用や処理時間を縮小できること。

<!-- レスポンスヘッダの

- Pragma
- Expires
- Chache

を見ると、キャッシュについてよく分かる。 -->

### 統一インターフェース

統一インターフェースとは URI で示したリソースに対する操作を統一した限定的なインターフェイスで行うアーキテクチャスタイルのこと。

リソースに対する操作とは CRUD のこと。

限定的なインターフェイスとは GET や POST などの HTTP メソッドとのこと。

メリットとして、インターフェイスが統一されることで、サーバとクライアントがお互いを意識せずに実装できる。

### 階層化システム

階層化システムとは、システムをいくつかの階層に分離するアーキテクチャスタイルのこと。

例えば、クライアントとサーバ間にロードバランサを設置したり、プロキシを設置したりする。

### コードオンデマンド

コードオンデマンドとは、プログラムコードをサーバからダウンロードし、クライアント側で実行するアーキテクチャスタイルのこと。

メリットとして、クライアントのプログラムを後から追加することができる。

## REST API について

Roy Fielding さんの REST をどのように使って現在の Web システムが設計されているかについて説明していく。

REST API の設計の最も重要なことは以下の 2 つに要約される。

※API：ソフトウェアコンポーネント同士が互いに情報をやりとりするのに使用するインタフェースの仕様のこと。

- URI はリソースを表現しなければならない
- リソースに対する操作は、HTTP メソッド（GET、POST、PUT、DELETE）で表現する

### リソースとは

ここで言うリソースとは**ウェブサイトを構成する文章や画像など**を指す。

リソースの具体的な例を以下に示すと、

- 東京の天気
- サメのフリー画像
- メールの受信トレイ

などなどである。

ここで重要なのは REST において、名前のつくもの(名詞になるもの)は全部リソースであるということ。

上記のリソースの例は、全部 Web 上に存在するものばかりである。

- 「東京の天気予報」は Yahoo Japan の東京地方の天気予報のページ
- 「サメのフリー画像」はいらすとやのサメのイラスト（魚）の画像
- 「メールの受信トレイ」は Gmail の受信トレイ

で、全てのリソースは識別子として、URI を持つ。
例の URI は以下の様になる。

- https://weather.yahoo.co.jp/weather/jp/13/4410.html
- https://www.irasutoya.com/2013/01/blog-post_29.html
- https://mail.google.com/mail/u/0/#inbox

この例の通り、リソースは URI で一意に識別することができる。
URI で識別される情報は時間や条件によって内容が変化する場合がある。

例えば、「東京の天気予報」は、今日見る場合と明日見る場合で含まれる内容は変わってくる。

つまり、内容は取得する時点でのリソースの状態(state)で決まると言える。

しかし、両者とも「東京の天気予報」であることは変わらず、意味は不変(同じ名詞である)。

これまでの説明で REST におけるリソースの特徴は以下のようにまとめることができる。

- 全ての情報はリソース
- リソースは識別子(URI)を持つ
- リソースの状態は時間や条件とともに変化する可能性がある
- リソースの意味は時間や条件が変化しても不変

### リソースを URI で表現する方法

リソースを URI で表現するには API 利用者が客観的に見て、意味が分かる名詞であることが必要。

例えば、本に関する REST API があったとすると、「本」に関する操作をしていくと思われる。

しかし、あくまで URI は「名詞」であるため、本は**books**というリソース名で定義する。

リソースが定義できたら、次はそれらに関してどんなアクションが必要であるかを考える。

REST の原則では、HTTP メソッドを使った CRUD 操作は GET, POST, PUT, PATCH, DELETE がある。

これらを使って、本に対して必要なアクションと、それを満たす URI は以下の様になる。

| アクション                              | URI             |
| --------------------------------------- | --------------- |
| 本の一覧を取得する                      | GET /books      |
| 指定した本(#15)の情報を取得する         | GET /books/15   |
| 新しい本を登録する                      | POST /books     |
| 指定した本(#15)の情報を更新する         | PUT books/15    |
| 指定した本(#15)の情報を部分的に更新する | PATCH books/15  |
| 指定した本(#15)を削除する               | DELETE books/15 |

## 参考文献

Roy Thomas Fielding | CHAPTER 5 Representational State Transfer (REST)
(最終閲覧日：2021 年 2 月 1 日）
https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm

Qiita | ステートレスとは
(最終閲覧日：2021 年 2 月 1 日）
https://qiita.com/mtakehara21/items/efcbbc3ba58a62c10eb6

カイホー | WEB のアーキテクチャスタイル（設計思想） REST
(最終閲覧日：2021 年 2 月 1 日）
http://kaihooo.com/rest/

Qiita | REST とは何者なのか【備忘録】
(最終閲覧日：2021 年 2 月 1 日）
https://qiita.com/Ryoga_aoym/items/7a5a12420a3fecf629ba

Qiita | 【本】「Web を支える技術」の REST について
Qiita | REST とは何者なのか【備忘録】
(最終閲覧日：2021 年 2 月 1 日）
https://qiita.com/ksk_lack/items/29c354a80743bae153ac

Qiita | RESTful API とは何なのか
(最終閲覧日：2021 年 2 月 1 日）
https://qiita.com/NagaokaKenichi/items/0647c30ef596cedf4bf2

TOAST Meetup! | REST API を正しく理解して使用する
https://meetup-jp.toast.com/931

瀬戸内の雲のように | REST API とは何か？をわかりやすく説明するために論文を読んでみた
(最終閲覧日：2021 年 2 月 1 日）
https://www.setouchino.cloud/blogs/81

Wikipedia | アプリケーションプログラミングインタフェース
(最終閲覧日：2021 年 2 月 1 日）
https://ja.wikipedia.org/wiki/%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9#API%E3%81%A8%E3%83%97%E3%83%AD%E3%83%88%E3%82%B3%E3%83%AB

yohei-y:weblog | REST 入門
(最終閲覧日：2021 年 2 月 1 日）
http://yohei-y.blogspot.com/2005/04/rest_23.html

Qiita | 翻訳: WebAPI 設計のベストプラクティス
(最終閲覧日：2021 年 2 月 1 日）
https://qiita.com/mserizawa/items/b833e407d89abd21ee72#%E5%8F%AF%E8%83%BD%E3%81%AA%E9%99%90%E3%82%8A-json-%E3%81%A7%E8%BF%94%E3%81%9D%E3%81%86
